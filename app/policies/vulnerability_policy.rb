class VulnerabilityPolicy < ApplicationPolicy
  include RecordPolicy

  def permitted_attributes
    [:codename,
     :feed,
     :vendors_str,
     :products_str,
     :cvss3,
     :cvss3_vector,
     :cvss3_exploitability,
     :cvss3_impact,
     :cvss2,
     :cvss2_vector,
     :cvss2_exploitability,
     :cvss2_impact,
     :cpe,
     :published,
     :published_time,
     :modified,
     :modified_time,
     :state,
     :custom_actuality,
     :custom_relevance,
     :custom_description,
     :custom_references,
     {custom_fields: Vulnerability.custom_fields_names},
     :custom_recomendation]
  end

  def search?
    index?
  end

  def actual_and_relevant?
    index?
  end

  def run?
    create?
  end

  class Scope < Scope
    def resolve
        scope.all
    end
  end
end
