class VulnerabilityPolicy < ApplicationPolicy
  include RecordPolicy

  def permitted_attributes
    [:codename,
     :year,
     :feed,
     :vendors,
     :products,
     :versions,
     :cvss3,
     :cvss3_vector,
     :cvss3_exploitability,
     :cvss3_impact,
     :cvss2,
     :cvss2_vector,
     :cvss2_exploitability,
     :cvss2_impact,
     :cpe,
     :published,
     :published_time,
     :modified,
     :modified_time,
     :feed_description,
     :description]
  end

  def search?
    index?
  end

  def run?
    create?
  end

  class Scope < Scope
    def resolve
        scope.all
    end
  end
end
