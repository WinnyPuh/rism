class Vulnerability < ApplicationRecord
  include Vulnerability::Ransackers

  enum feed: %i[
               custom
               nvd
             ]

  validates :codename, uniqueness: true
  validates :codename, length: { in: 3..250 }
  validates :cvss3, inclusion: { in: 0.1..10.0, allow_blank: true }
  validates :feed, inclusion: { in: Vulnerability.feeds.keys}
end
